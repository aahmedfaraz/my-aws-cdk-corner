# Step by Step Screenshots of working app

# Userpool Before

<img src="https://github.com/aahmedfaraz/my-aws-cdk-corner/blob/main/step11_cognito/example02_cognito_userpool_with_frontend_amplify/assets/1_userpool_before.PNG" alt="image">

# Created User

<img src="https://github.com/aahmedfaraz/my-aws-cdk-corner/blob/main/step11_cognito/example02_cognito_userpool_with_frontend_amplify/assets/2_created_user.PNG" alt="image">

# Asking Verification Code

<img src="https://github.com/aahmedfaraz/my-aws-cdk-corner/blob/main/step11_cognito/example02_cognito_userpool_with_frontend_amplify/assets/3_asking_verification_code.PNG" alt="image">

# Recieved verification code via Email

<img src="https://github.com/aahmedfaraz/my-aws-cdk-corner/blob/main/step11_cognito/example02_cognito_userpool_with_frontend_amplify/assets/4_recieved_verification_code_email.PNG" alt="image">

# Entered verification code

<img src="https://github.com/aahmedfaraz/my-aws-cdk-corner/blob/main/step11_cognito/example02_cognito_userpool_with_frontend_amplify/assets/5_entered_verification_code.PNG" alt="image">

# Successfully Signed In

<img src="https://github.com/aahmedfaraz/my-aws-cdk-corner/blob/main/step11_cognito/example02_cognito_userpool_with_frontend_amplify/assets/0_SignedIn.PNG" alt="image">

# When Signing In using SignIn Form

<img src="https://github.com/aahmedfaraz/my-aws-cdk-corner/blob/main/step11_cognito/example02_cognito_userpool_with_frontend_amplify/assets/6_Signing_In.PNG" alt="image">

# Successfully Signed In

<img src="https://github.com/aahmedfaraz/my-aws-cdk-corner/blob/main/step11_cognito/example02_cognito_userpool_with_frontend_amplify/assets/0_SignedIn.PNG" alt="image">

# Userpool After

<img src="https://github.com/aahmedfaraz/my-aws-cdk-corner/blob/main/step11_cognito/example02_cognito_userpool_with_frontend_amplify/assets/7_userpool_after.PNG" alt="image">

# How to use Amplify after Installation (Step by Step)

Now amplify is updated, this documents is according to updated version

# Install

```powershell
npm install -g @aws-amplify/cli
```

# How to use

## 1. Configure the Amplify CLI

```powershell
amplify configure
```

It will allow you to create a new IAM user for Amplify or use existing one

## 2. Initialize amplify in your project root directory

```powershell
amplify init
```

## 3. Add a feature, Here I am using for Auth

```powershell
amplify add auth
```

and then go for default configs to add your existing Cognito userpool

```powershell
PS E:\GitHub\my-aws-cdk-corner\step11_cognito\example02_cognito_userpool_with_frontend_amplify\gatsby_amplify_frontend> amplify add auth
Using service: Cognito, provided by: awscloudformation

 The current configured provider is Amazon Cognito.

 Do you want to use the default authentication and security configuration? Default configuration
 Warning: you will not be able to edit these selections.
 Do you want to configure advanced settings? No, I am done.
✅ Successfully added auth resource amplifyforcognito81a8039d locally

✅ Some next steps:
"amplify push" will build all your local backend resources and provision it in the cloud
"amplify publish" will build all your local backend and frontend resources (if you have hosting category added) and provision it in the cloud
```

## 4. Amplify push

`amplify push` will build all your local backend resources and provision it

```powershell
amplify push
```

# How files will be looking like

## wrap-root-element.js

```js
import React from "react";
import Amplify, { Auth } from "aws-amplify";
import awsmobile from "../aws-exports";
import { AmplifyProvider } from "@aws-amplify/ui-react";
import "@aws-amplify/ui-react/styles.css";

const wrapRootElement = ({ element }) => {
  Amplify.configure(awsmobile);

  // You can get the current config object
  const currentConfig = Auth.configure();
  console.log("currentConfig", currentConfig);

  return <AmplifyProvider>{element}</AmplifyProvider>;
};

export default wrapRootElement;
```

## aws-exports.js

This file could include much more than mention accordingly

```js
/* eslint-disable */
// WARNING: DO NOT EDIT. This file is automatically generated by AWS Amplify. It will be overwritten.

const awsmobile = {
  aws_project_region: "xxxxxx",
  Auth: {
    region: "xxxxxx",
    userPoolId: "xxxxxxxxxxxxxxxxxx",
    userPoolWebClientId: "xxxxxxxxxxxxxxxxxxxxxxxx",
  },
};

export default awsmobile;
```

## index.js

```js
import React from "react";
import { Authenticator } from "@aws-amplify/ui-react";

const Home = () => {
  return (
    <Authenticator>
      {({ signOut, user }) => (
        <main>
          <h1>Hello {user.username}</h1>
          <button onClick={signOut}>Sign out</button>
        </main>
      )}
    </Authenticator>
  );
};

export default Home;
```
